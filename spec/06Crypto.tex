\chapter{Криптографическая поддержка}\label{CRYPTO}

\section{Параметры эллиптической кривой}\label{CRYPTO.Params}

В криптографических алгоритмах ЭЦП и транспорта ключа должны
использоваться стандартные параметры ЭК, 
установленные в СТБ 34.101.45 (приложение Б). 
%
Имеется три набора параметров для каждого из трех уровней стойкости~$l$.
%
В СТБ 34.101.45 (приложение Д) стандартным параметрам ЭК назначены 
идентификаторы 
\texttt{bign-curve256v1} ($l=128$), 
\texttt{bign-curve384v1} ($l=192$), 
\texttt{bign-curve512v1} ($l=256$).
%
Уровень~$l$, кроме параметров ЭК, определяет также длины личного и 
открытого ключей криптографических алгоритмов.

Параметры ЭК описываются типом~\texttt{DomainParameters},
определенным в СТБ 34.101.45 (приложение Д). Для описания параметров
должен быть выбран компонент~\texttt{named} типа~\texttt{DomainParameters},
и этот компонент должен содержать один из трех указанных выше
идентификаторов.

\section{Алгоритмы хэширования}\label{CRYPTO.Hash}

Для хэширования подписываемых данных должен использоваться один из
алгоритмов~\texttt{belt-hash}, \texttt{bash384} или~\texttt{bash512}.
%
Алгоритм~\texttt{belt-hash} установлен в СТБ 34.101.31,
алгоритмы~\texttt{bash384} и~\texttt{bash512}~--- в СТБ 34.101.77.
%
Алгоритмы возвращают соответственно $256$-, $384$- 
и~$512$-битовые хэш-значения.

\section{Алгоритмы шифрования}\label{CRYPTO.Encr}

Для шифрования конвертуемых данных должны использоваться либо
алгоритмы~\texttt{belt-cfb}, либо алгоритмы~\texttt{belt-ctr}.
%
Алгоритмы установлены в СТБ 34.101.31.
%
Алгоритмы~\texttt{belt-cfb} реализуют шифрование в режиме гаммирования с 
обратной связью, алгоритмы~\texttt{belt-ctr}~--- в режиме счетчика.

В алгоритмах шифрования должны использоваться $256$-битовые ключи.

\section{Алгоритмы электронной цифровой подписи}\label{CRYPTO.Sign}

Для проверки и выработки ЭЦП должны использоваться алгоритмы,
установленные в СТБ 34.101.45. 
%
В алгоритмах должны использоваться стандартные параметры ЭК 
(см.~\ref{CRYPTO.Params}), определяемые выбранным уровнем стойкости~$l$.

Уровень стойкости, кроме параметров ЭК и длин ключей,
определяет также вспомогательный алгоритм хэширования,
уточняющий алгоритмы ЭЦП.

На уровне~$l=128$ вместе с параметрами~\texttt{bign-curve256v1}
должен использоваться алгоритм~\texttt{belt-hash}. 
Уточненным алгоритмам ЭЦП назначается идентификатор~\texttt{bign-with-hbelt}, 
определенный в СТБ 34.101.45 (приложение Д). 

На уровне~$l=192$ вместе с параметрами~\texttt{bign-curve384v1}
должен использоваться алгоритм~\texttt{bash384}. 
Уточненным алгоритмам ЭЦП назначается 
идентификатор~\texttt{bign-with-bash384},  
определенный в СТБ 34.101.77 (приложение Б).

На уровне~$l=256$ вместе с параметрами~\texttt{bign-curve512v1}
должен использоваться алгоритм~\texttt{bash512}. 
Уточненным алгоритмам ЭЦП назначается 
идентификатор~\texttt{bign-with-bash512},  
определенный в СТБ 34.101.77 (приложение Б).

Формат ЭЦП определяется в СТБ 34.101.45 (приложение Д).

\section{Алгоритмы транспорта ключа}\label{CRYPTO.Transport}

Для транспорта ключа должны использоваться алгоритмы~\texttt{bign-keytransport},
установленные в СТБ 34.101.45. 
%
В алгоритмах должны использоваться стандартные параметры 
ЭК (см.~\ref{CRYPTO.Params}). 

Формат защищенного транспортируемого ключа (токена ключа)
определяется в СТБ 34.101.45 (приложение Д). 

\section{Описание алгоритмов}\label{CRYPTO.AlgId}

Для описания криптографических алгоритмов используется 
тип~\texttt{AlgorithmIdentifier}, определенный в СТБ 34.101.19.
Компонентами типа является идентификатор алгоритма и параметры
алгоритма. 

При описании алгоритмов 
\texttt{belt-hash}, \texttt{bash384}, \texttt{bash512},
\texttt{bign-with-hbelt}, \texttt{bign-with-bash384}, 
\texttt{bign-with-bash512} и \texttt{bign-keytransport} компонент параметров 
должен принимать значение \texttt{NULL}.

При описании алгоритмов \texttt{belt-cfb}, \texttt{belt-ctr}
в компонент параметров записывается синхропосылка.
Формат синхропосылки описан в СТБ 34.101.31 (приложение Б).

\section{Открытый ключ}\label{CRYPTO.Pubkey}

Открытый ключ алгоритмов \texttt{bign-with-hbelt}, \texttt{bign-with-bash384}, 
\texttt{bign-with-bash512} и \texttt{bign-keytransport}
описывается типом~\texttt{SubjectPublicKeyInfo}, 
определенным в СТБ 34.101.45 (приложение Д).

