\section{Запрос на отзыв сертификата}\label{FMT.BPKIRevokeReq}

Формат запроса на отзыв сертификата определяется следующим типом АСН.1:
\begin{verbatim}
BPKIRevokeReq ::= SEQUENCE {
  issuer          Name,
  serialNumber    INTEGER,
  revokePwd       UTF8String,
  reasonCode      CRLReason,      
  invalidityDate  GeneralizedTime OPTIONAL,
  comment         UTF8String OPTIONAL }
\end{verbatim}

Компонент~\texttt{issuer} содержит идентификационные данные эмитента 
отзываемого сертификата.

Компонент~\texttt{serialNumber} содержит серийный номер отзываемого 
сертификата.

Компонент \texttt{revokePwd} содержит пароль отзыва
сертификата, который является действительным в 
настоящий момент. Этот пароль должен быть предварительно
установлен с помощью процесса~\texttt{Setpwd} (см.~\ref{PROCESSES.Setpwd}). 

Компоненты \texttt{reasonCode} и~\texttt{invalidityDate}
содержат рекомендации УЦ по заполнению записи об отзыве сертификата
(см. описание одноименных компонентов в~\ref{FMT.CRL}).
УЦ может учесть рекомендации или проигнорировать их.

Опциональный компонент~\texttt{comment} содержит дополнительную информацию 
о причине отзыва.
 
\section{Список отозванных сертификатов}\label{FMT.CRL}

СОС издает УЦ, ранее выпустивший отозванные сертификаты.
Формат СОС описывается типом \texttt{CertificateList}, который определен в 
СТБ 34.101.19. 

Идентификатор алгоритмов ЭЦП, указываемый в основном 
контейнере~\texttt{CertificateList} и дублируемый во вложенном  
контейнере~\texttt{TBSCertList}, должен быть выбран из перечня,  
заданного в~\ref{CRYPTO.Sign}. Этот идентификатор должен соответствовать 
открытому ключу издателя СОС (см.~\ref{CRYPTO.Keypair}).

Вложенный контейнер~\texttt{TBSCertList} заполняется по правилам СТБ 
34.101.19 со следующими уточнениями.

\begin{enumerate}
\item
Идентификационные данные издателя СОС, которые указываются в 
компоненте~\texttt{issuer}, должны повторять данные в одноименном 
компоненте его сертификата. 

\item
В каждую запись об отозванном сертификате 
(компонент~\texttt{revokedCertificates}) должно включаться 
расширение~\texttt{reasonCode} с кодом причины отзыва сертификата. 
%
В запись может включаться расширение~\texttt{invalidityDate}, которое 
описывает момент наступления события, повлекшего отзыв.

В расширении~\texttt{reasonCode} могут использоваться следующие коды:
\begin{itemize}
\item[--]
\texttt{unspecified}~--- неопределенная причина;
\item[--]
\texttt{keyCompromise}~--- компрометация личного ключа конечного участника 
(кроме ЦАС); 
\item[--]
\texttt{cACompromise}~--- компрометация личного ключа УЦ;
\item[--]
\texttt{affiliationChanged}~--- смена идентификационных данных субъекта;
\item[--]
\texttt{superseded}~--- смена сертификата (с помощью~\texttt{Reenroll}, 
см.~\ref{PROCESSES.Reenroll}); 
\item[--]
\texttt{cessationOfOperation}~--- закрытие УЦ;
\item[--]
\texttt{aACompromise}~--- компрометация личного ключа ЦАС.
\end{itemize}

\item
В список расширений СОС (компонент~\texttt{crlExtensions})
должны быть включены расширении~\texttt{AuthorityKeyIdentifier} 
и~\texttt{CRLNumber}. Первое расширение формируется по правилам,
заданным в~\ref{FMT.Ext.SKID}. Номер текущего СОС в~\texttt{CRLNumber}
должен быть неотрицательным целым числом, DER-код которого укладывается в 
20 октетов. Номера последовательных СОС должны монотонно возрастать.
\end{enumerate}
