\section{Запрос на отзыв сертификата}\label{FMT.BPKIRevokeReq}

Формат запроса на отзыв сертификата определяется следующим типом АСН.1:
\begin{verbatim}
BPKIRevokeReq ::= SEQUENCE {
  issuer          Name,
  serialNumber    INTEGER,
  revokePwd       UTF8String,
  reasonCode      CRLReason,
  invalidityDate  GeneralizedTime OPTIONAL,
  comment         UTF8String OPTIONAL }
\end{verbatim}

Компонент~\texttt{issuer} содержит идентификационные данные эмитента 
отзываемого сертификата.

Компонент~\texttt{serialNumber} содержит серийный номер отзываемого 
сертификата.

Компонент \texttt{revokePwd} содержит пароль отзыва
сертификата, который является действительным в 
настоящий момент. Этот пароль может быть предварительно
задан в атрибуте~\texttt{challengePassword} запроса на получение сертификата 
(см.~\ref{FMT.CSR.CP}) или установлен с помощью процесса~\texttt{Setpwd} 
(см.~\ref{PROCESSES.Setpwd}). 

Компоненты \texttt{reasonCode} и~\texttt{invalidityDate}
содержат рекомендации УЦ по заполнению записи об отзыве сертификата
(см. описание одноименных компонентов в~\ref{FMT.CRL}).
УЦ может учесть рекомендации или проигнорировать их.

Опциональный компонент~\texttt{comment} содержит дополнительную информацию 
о причине отзыва.
 
\section{Список отозванных сертификатов}\label{FMT.CRL}

СОС описывается типом \texttt{CertificateList}, 
который определен в СТБ 34.101.19.

COC составляется по правилам СТБ 34.101.19 со следующими уточнениями:
\begin{enumerate}

\item
Идентификационные данные издателя (подразумевается УЦ, 
выпустивший СОС) задаются компонентом \texttt{issuer}, 
который должен повторять компонент \texttt{subject} из 
сертификата эмитента данного СОС.  
%

\item

В запись об отозванном сертификате должно включаться
расширение~\texttt{reasonCode}, которое содержит код причины отзыва
сертификата.
%
В запись может включаться расширение~\texttt{invalidityDate}, которое 
описывает момент наступления события, повлекшего отзыв.

В~\texttt{reasonCode} могут использоваться следующие коды:
\begin{itemize}
\item[--]
\texttt{unspecified}~--- неопределенная причина;
\item[--]
\texttt{keyCompromise}~--- компрометация личного ключа конечного участника 
(кроме ЦАС); 
\item[--]
\texttt{cACompromise}~--- компрометация личного ключа УЦ;
\item[--]
\texttt{affiliationChanged}~--- смена идентификационных данных субъекта;
\item[--]
\texttt{superseded}~--- смена сертификата (с помощью~\texttt{Reenroll}, 
см.~\ref{PROCESSES.Reenroll}); 
\item[--]
\texttt{cessationOfOperation}~--- закрытие УЦ;
\item[--]
\texttt{aACompromise}~--- компрометация личного ключа ЦАС.
\end{itemize}

\item
Расширения СОС указываются в компоненте~\texttt{crlExtensions}.
Должны использоваться следующие расширения СОС:
\begin{enumerate}
\item 
Расширение~\texttt{AuthorityKeyIdentifier}, в котором задается 
хэш-значение открытого ключа эмитента СОС. 
%
Сохраняются определенные в~\ref{FMT.Ext.SKID} правила формирования 
расширения.

\item
Расширение~\texttt{CRLNumber}, в котором задается номер текущего СОС.
Номер представляется неотрицательным целым числом, 
DER-код которого укладывается в 20 октетов. 
Номера последовательных СОС должны монотонно возрастать.
\end{enumerate}

\end{enumerate}

Все опциональные компоненты, про которые не сказано в уточнениях, 
должны быть опущены.
