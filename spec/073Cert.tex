\section{Сертификат открытого ключа}\label{FMT.Cert}

Сертификат открытого ключа описывается типом 
\texttt{Certificate}, который определен в СТБ 34.101.19.
%
Cертификат состоит из информационной части, которая 
подписывается, идентификатора алгоритма подписи и ЭЦП. 
Правила задания двух последних компонентов определены 
в~\ref{CRYPTO.AlgId}, \ref{CRYPTO.Sign}.

Информационная часть сертификата описывается типом 
\texttt{TBSCertificate} и включает версию синтаксиса, 
серийный номер сертификата, идентификатор алгоритма подписи (повторно), 
идентификационные данные эмитента, срок действия сертификата, 
идентификационные данные субъекта, информацию об открытом ключе 
субъекта и расширения. 

Версия синтаксиса указывается в компоненте \texttt{version}.
Должна использоваться $3$-ая версия, она кодируется значением~$2$
компонента.

Серийный номер сертификата указывается в компоненте \texttt{serialNumber}.
Серийный номер должен быть положительным целым числом, 
DER-код которого укладывается в 20 октетов.
%
УЦ должен гарантировать уникальность серийных 
номеров всех выпускаемых сертификатов, даже тех, которые 
подписываются на разных личных ключах УЦ.

Идентификационные данные эмитента и субъекта указываются в
компонентах~\texttt{issuer} и~\texttt{subject} соответственно. Компоненты
имеют тип \texttt{Name} и заполняются в соответствии с
подразделом~\ref{ENTITIES.Name}.

Срок действия сертификата описывается компонентом 
\texttt{validity}. Срок действия назначается эмитентом
при выполнении процессов~\texttt{Enroll} и~\texttt{Spawn}
(см.~\ref{PROCESSES.Enroll} и~\ref{PROCESSES.Spawn}). 

Продолжительность действия сертификатов субъектов различных ролей
не должна превышать значений, указанных в таблице~\ref{Table.CERT.Validity}. 
%
При этом, как обычно, сертификаты операторов подчиняются правилам для ЮП, 
а сертификаты агентов~--- правилам для КА.

Срок действия может быть продлен с помощью процесса~\texttt{Reenroll}
(см.~\ref{PROCESSES.Reenroll}). При продлении ограничения
таблицы~\ref{Table.CERT.Validity} не должны нарушаться.

\begin{table}
\caption{Сроки действия сертификатов}
\label{Table.CERT.Validity}
\begin{tabular}{|l|c|c|}
\hline
Сторона & Уровень стойкости & Максимальный срок\\
        &                   & действия (лет)\\
\hline
\hline

КУЦ & $l=128$ & 20\\
\cline{2-3} & $l=192$ & 30\\
\cline{2-3} & $l=256$ & 40\\
\hline

РУЦ & $l=128$ & 15\\
\cline{2-3} & $l=192$ & 20\\
\cline{2-3} & $l=256$ & 30\\
\hline

ПУЦ, СШВ,    & $l=128$ & 5\\
\cline{2-3}
СЗД, ЦАС,    & $l=192$ & 8\\
\cline{2-3} 
РЦ           & $l=256$ & 10\\
\hline

OCSP, TLS,  & $l=128$ & 3 \\
\cline{2-3}
СИ, КА & $l=192$ & 4\\
\cline{2-3} & $l=256$ & 5\\
\hline

ФЛ, ЮП & $l=128$ & 2 \\
\cline{2-3} & $l=192$ & 3 \\
\cline{2-3} & $l=256$ & 4 \\
\hline
\end{tabular}
\end{table}

Открытый ключ субъекта указывается в
компоненте~\texttt{subjectPublicKeyInfo}. Правила описания открытого ключа
определены в~\ref{CRYPTO.Pubkey}.

Расширения указываются в компоненте \texttt{еxtensions}. При задании
расширений должны использоваться правила~\ref{FMT.Ext}.
